;/*FB_PKG_DELIM*/

__d("IGDLocalContactSearchSource",["polarisDirectSelectors"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a,this.$2=d("polarisDirectSelectors").getCreatorInboxThreadIds(a,{activeTab:null})}var b=a.prototype;b.getSortedThreadIds=function(){return this.$2};b.getUser=function(a){return this.$1.direct.users.get(a)};b.getThread=function(a){return this.$1.direct.threads.get(a)};return a}();g["default"]=a}),98);
__d("IGDContactSearchResultConverter",["fbt","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){var b=a.interop_messaging_user_fbid!=null?String(a.interop_messaging_user_fbid):"";return{candidate:{id:b,igid:a.id,imageUrl:a.profile_pic_url,isDisappearingModeSettingOn:!1,isE2EE:!1,isInstamadilloCutover:!1,isVerified:a.is_verified,otherUserId:void 0,subtext:a.username,threadName:i(a)},type:"user"}}function b(a,b,c){var d=a.users.length,e=(d===0?[a.admin_user_ids[0]]:d===1?[a.viewer_id].concat(a.users):a.users.slice(0,2)).map(b);e=e.concat(null,null).slice(0,2).map(function(a){return(a=a==null?void 0:a.profile_pic_url)!=null?a:""});b=a.users.slice(0,2).map(b);var f=j(b,d,"subtext");c=c==="client"||a.named?a.thread_title:j(b,d,"threadName");return{candidate:{id:a.messaging_thread_key,igid:a.id,imageUrl:e[0],isDisappearingModeSettingOn:!1,isE2EE:!1,isInstamadilloCutover:!1,secondaryImageUrl:e[1],subtext:f,threadName:c},type:"thread"}}function i(a){var b=a==null?void 0:a.full_name;a=(a=a==null?void 0:a.username)!=null?a:"";return c("isStringNullOrEmpty")(b)?a:b}var j=function(a,b,c){if(b===0)return h._("__JHASH__fNP-hVB6t-K__JHASH__").toString();var d=function(b){return c==="threadName"?i(a[b]):(b=(b=a[b])==null?void 0:b.username)!=null?b:""};if(b===1)return d(0);var e=d(0);d=d(1);if(b===2)return h._("__JHASH__Tjyc-QEn6JB__JHASH__",[h._param("user1",e),h._param("user2",d)]).toString();return b===3?h._("__JHASH__WJlt-PvGJvu__JHASH__",[h._param("user1",e),h._param("user2",d),h._param("remainingCount",1)]).toString():h._("__JHASH__ov9SQq9yrz___JHASH__",[h._param("user1",e),h._param("user2",d),h._param("remainingCount",b-2)]).toString()};d={convertThreadCandidate:b,convertUserCandidate:a};g["default"]=d}),98);
__d("IGDLocalContactSearcher",["IGDContactSearchResultConverter"],(function(a,b,c,d,e,f,g){"use strict";var h=10,i=10;a=function(){function a(a,b){this.$3=new Map(),this.$4=new Map(),this.$5=new Map(),this.$6=new Map(),this.$7=new Map(),this.$1=a,this.$2=b}var b=a.prototype;b.search=function(a){this.$4=new Map();this.$5=new Map();this.$6=new Map();this.$7=new Map();a=j(a);if(!a.length)return{data:this.$8(),isFinal:!0};var b=this.$2.getSortedThreadIds();for(var b=b,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(this.$9()&&this.$10())break;e=this.$2.getThread(e);if(e==null)continue;e.is_group?this.$11(a,e):this.$12(a,e.users[0])}e=new Map([].concat(Array.from(this.$4.entries()),Array.from(this.$5.entries()),Array.from(this.$6.entries()),Array.from(this.$7.entries())));return{data:e,isFinal:!1}};b.$8=function(){this.$3.size===0&&(this.$3=this.$13());return this.$3};b.$13=function(){var a=this,b=new Map(),d=[],e=function(){return b.size>=h+i},f=this.$2.getSortedThreadIds();for(var g=0;g<f.length;g++){if(e())break;var j=f[g],k=this.$2.getThread(j);if(k==null)continue;if(!k.is_group){var l=this.$2.getUser(k.users[0]);l&&!b.has(l.id)&&b.set(l.id,c("IGDContactSearchResultConverter").convertUserCandidate(l))}else this.$1&&!b.has(j)&&b.set(j,c("IGDContactSearchResultConverter").convertThreadCandidate(k,function(b){return a.$2.getUser(b)},"client")),d.push.apply(d,k.users)}l=new Set(d);for(j=l,k=Array.isArray(j),g=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(g>=j.length)break;f=j[g++]}else{g=j.next();if(g.done)break;f=g.value}d=f;if(e())break;if(b.has(d))continue;l=this.$2.getUser(d);l&&b.set(l.id,c("IGDContactSearchResultConverter").convertUserCandidate(l))}return b};b.$9=function(){return this.$4.size+this.$5.size>=h};b.$10=function(){return this.$1?this.$6.size+this.$7.size>=i:!0};b.$14=function(a,b){if(this.$4.has(b)||this.$5.has(b))return!0;b=this.$2.getUser(b);if(!b)return!1;var c=[{kind:"fullname",name:b.full_name},{kind:"username",name:b.username}];for(var d=0;d<c.length;d++){var e=c[d],f=e.kind;e=e.name;e=j(e);if(k(e,a))return{kind:f,user:b}}return!1};b.$12=function(a,b){if(this.$9())return;a=this.$14(a,b);if(typeof a==="object"){b=a.kind;a=a.user;this.$15(a,b)}};b.$11=function(a,b){var c=this,d=this.$10();if(!d){var e=j(b.thread_title);k(e,a)&&(this.$16(b,function(a){return c.$2.getUser(a)},this.$6),d=!0)}for(var e=b.users,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;if(d&&this.$9())break;h=this.$14(a,h);!d&&Boolean(h)&&(this.$16(b,function(a){return c.$2.getUser(a)},this.$7),d=!0);if(!this.$9()&&typeof h==="object"){var i=h.kind;h=h.user;this.$15(h,i)}}};b.$15=function(a,b){if(this.$4.has(a.id)||this.$5.has(a.id))return;var d=c("IGDContactSearchResultConverter").convertUserCandidate(a);b=b==="fullname"?this.$4:this.$5;b.set(a.id,d)};b.$16=function(a,b,d){if(this.$6.has(a.id)||this.$7.has(a.id))return;b=c("IGDContactSearchResultConverter").convertThreadCandidate(a,b,"client");d.set(a.id,b)};return a}();function j(a){return a==null?"":a.toLowerCase().replace(/\s/g,"")}function k(a,b){return a.length>=b.length&&a.includes(b)}g["default"]=a}),98);
__d("IGDServerContactSearcher",["CometDebounce","IGDContactSearchResultConverter","PolarisDirectAPI","asyncToGeneratorRuntime","polarisNormalizeDirectThreads","polarisNormalizeDirectUsers","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=10;a=function(){function a(a,b){this.$1="",this.$3=new Map(),this.$2=a,this.$4=b}var b=a.prototype;b.search=function(a,b,c){var d=this;this.$1=b;if(!a)return;this.$5(b,function(a){if(d.$1!==b)return;a=j(a,d.$4);c(a)})};b.$5=function(a,b){var c=this.$3;if(c.has(a)){b(c.get(a));return}i(a,this.$2,function(d){d&&c.set(a,d),b(d)})};return a}();var i=c("CometDebounce")(function(a,e,f){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;try{b=(yield d("PolarisDirectAPI").getRankedRecipientsWithParams({max_ig_results:h,mode:"reshare",query:a,show_threads:e}))}catch(a){}f(b)})())},{wait:200});function j(a,b){if(!a||!a.ranked_recipients)return null;var e=new Map();for(var f of a.ranked_recipients)if(f.user){a=f.user;var g=d("polarisNormalizeDirectUsers").normalizeDirectUsers([a]);g=g.entities;g=g.users[a.pk];a=c("IGDContactSearchResultConverter").convertUserCandidate(g);e.set(g.id,a)}else f.thread&&(function(){var a=f.thread,d=c("polarisNormalizeDirectThreads")([a]),g=d.entities;d=g.threads[a.thread_id];a=c("IGDContactSearchResultConverter").convertThreadCandidate(d,function(a){var c;return(c=(c=g.users)==null?void 0:c[a])!=null?c:b.getUser(a)},"server");e.set(d.id,a)})();return e}g["default"]=a}),98);
__d("IGDContactSearchService",["IGDLocalContactSearchSource","IGDLocalContactSearcher","IGDServerContactSearcher"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){b=new(c("IGDLocalContactSearchSource"))(b);this.$1=new(c("IGDLocalContactSearcher"))(a,b);this.$2=new(c("IGDServerContactSearcher"))(a,b)}var b=a.prototype;b.search=function(a,b){var c=this.$1.search(a);b(c);this.$2.search(!c.isFinal,a,function(a){a=h(c.data,a);b({data:a,isFinal:!0})})};b.searchLocal=function(a){return this.$1.search(a).data};return a}();function h(a,b){if(!b)return a;var c=new Map(a);for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];a.has(g)||c.set(g,f)}return c}g["default"]=a}),98);
__d("useIGDDjangoContactSearch",["IGDContactSearchService","react","react-redux-wwwig","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useMemo,k=b.useState;function a(a,b,e){var f=d("react-redux-wwwig").useStore(),g=c("useStable")(function(){return new(c("IGDContactSearchService"))(e,f.getState())}),h=k(function(){return g.searchLocal(a)}),l=h[0],m=h[1];h=k(!1);var n=h[0],o=h[1];i(function(){g.search(a,function(a){m(a.data),o(!a.isFinal)})},[g,a]);h=j(function(){if(b==null||b.length===0)return l;var a=new Map();for(var c=l.entries(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];b.includes(f.candidate.id)||a.set(g,f)}return a},[b,l]);return{isLoading:n,searchResultItems:h}}g["default"]=a}),98);
__d("IGDDjangoContactSearch.react",["useIGDDjangoContactSearch"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.children,d=a.excludedIDs,e=a.includeGroupSearch;a=a.searchQuery;a=c("useIGDDjangoContactSearch")(a,d,e);d=a.isLoading;e=a.searchResultItems;return b(d,e)}g["default"]=a}),98);
__d("IGDDjangoInboxLoader.react",["PolarisDirectActionInitInbox","PolarisReactRedux.react","react","usePolarisSelector"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(){j();return null}a.displayName=a.name+" [from "+f.id+"]";function j(){var a=d("PolarisReactRedux.react").useDispatch(),b=c("usePolarisSelector")(function(a){return a.direct.inboxLoaded}),e=c("usePolarisSelector")(function(a){return a.direct.inboxLoading});i(function(){!e&&!b&&a(d("PolarisDirectActionInitInbox").initInbox())},[a,b,e])}g["default"]=a}),98);