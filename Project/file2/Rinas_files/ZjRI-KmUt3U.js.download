;/*FB_PKG_DELIM*/

__d("IGDAWShareAttachment",["fbt","FBLogger","I64","IGDAWShareAttachmentUtils","LSDatabaseSingleton","MAWExternalId","MAWFetchXMABlob","MAWJids","MAWJobDefinitions","MAWMiActOnActThreadReadyDeferred","MAWTimedJob","MWQPLMarkers","Promise","QPLUserFlow","ReQL","WAArmadilloXMA.pb","WAJobOrchestratorTypes","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=3,m=h._("__JHASH__pGK09Wm4HSW__JHASH__").toString();function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield k||(k=c("LSDatabaseSingleton")));return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(b.tables.participants).getKeyRange((j||(j=d("I64"))).of_string(a)).map(function(a){return d("MAWJids").toUserJid((j||(j=d("I64"))).to_string(a.contactId))}))});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(c==null?void 0:c.isPrivate)!==!0&&a.viewerCanReshare===!0,f=c==null?void 0:c.username,g=d("IGDAWShareAttachmentUtils").generateNativeURL(babelHelpers["extends"]({},a,{ownerId:c==null?void 0:c.id,username:c==null?void 0:c.username}));g={buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:g};var h=(yield (i||(i=b("Promise"))).all([a.src,c==null?void 0:c.profilePictureUrl].map(function(a){return d("MAWFetchXMABlob").fetchBlob(a)}))),j=h[0];h=h[1];return!e?{defaultCTA:g,header_blob:h,header_title:f,overlayDescription:m,overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE}:{defaultCTA:g,header_blob:h,header_title:c==null?void 0:c.username,overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,preview_blob:j,title_text:a.caption}});return q.apply(this,arguments)}function a(a,b,c,d,e,f){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,m){var o=function(a){h!=null&&m!=null&&c("QPLUserFlow").addPoint(h,a,{instanceKey:m})};if(f.candidate.isE2EE==null)throw c("FBLogger")("igd_web_on_msgr").mustfixThrow("Open thread candidate not allowed for IGDAW XMA Attachment Share");return c("MAWMiActOnActThreadReadyDeferred")(yield k||(k=c("LSDatabaseSingleton")),(j||(j=d("I64"))).of_string(f.candidate.id),"IGDAWShareAttachment",function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c,j,k){c=k;j=f.candidate.id;k=(yield p(a,e));var q=k.defaultCTA,r=k.header_blob,s=k.header_title,t=k.overlayDescription,u=k.overlayIconGlyph,v=k.preview_blob;k=k.title_text;o(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_FETCH_SUCCESS);v=v==null?void 0:new File([v],"preview",{type:v.type});r=r==null?void 0:new File([r],"header",{type:r.type});v=(yield (i||(i=b("Promise"))).all([d("IGDAWShareAttachmentUtils").getImageFileArgs(v),d("IGDAWShareAttachmentUtils").getImageFileArgs(r)]));r=v[0];v=v[1];o(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.PREVIEW_FAVICON_SPEC_READY);var w=a.expiringAt==null?void 0:d("WATimeUtils").castToUnixTime(a.expiringAt);o(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FETCHING_DEVICES_FOR_XMA_SHARE);j=(yield n(j));yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!1,reason:"send-share-attachment",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},users:new Set(j)}));return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendXMAShareMsg",{args:{s2sInstanceKey:m,s2sUserFlowQPLEvent:h,xmaMessageType:d("IGDAWShareAttachmentUtils").getXMAType(a)},associatedMsgContent:(j=g)!=null?j:void 0,associatedMsgContentExternalId:g==null?void 0:d("MAWExternalId").generateExternalId(),chatJid:c,headerFile:(j=v)!=null?j:void 0,previewFile:(c=r)!=null?c:void 0,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},xmaArgs:{defaultCTA:q,headerTitle:(v=s)!=null?v:void 0,maxTitleNumOfLines:l,overlayDescription:t,overlayIconGlyph:u,targetExpiringAtSec:w,targetId:a.id,targetUsername:e==null?void 0:e.username,titleText:(j=k)!=null?j:void 0,xmaLayoutType:d("IGDAWShareAttachmentUtils").getXMALayoutType(a)},xmaMsgExternalId:d("MAWExternalId").generateExternalId()}))});return function(a,b,d){return c.apply(this,arguments)}}())});return r.apply(this,arguments)}g.shareIGPostAsSecureAttachment=a}),98);
__d("IGDSecureShareSheetCommentTextInput.react",["IGDSBox.react","IGDSTextInput.react","PolarisDirectStrings","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useImperativeHandle,k=b.useState,l=b.unstable_useMemoCache,m={commentTextInput:{display:"x78zum5",paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",transition:"x13vyecm",$$css:!0},hiddenCommentTextInput:{height:"xqtp20y",visibility:"xlshs6z",$$css:!0},visibleCommentTextInput:{height:"x5kalc8",visibility:"xnpuxes",$$css:!0}};function a(a,b){var e=l(8);a=a.isHidden;a=a===void 0?!1:a;var f=k(""),g=f[0],h=f[1];e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=function(a){h(a.target.value)},e[0]=f):f=e[0];f=f;var n;e[1]!==g?(n=function(){return{getComment:function(){return g}}},e[1]=g,e[2]=n):n=e[2];j(b,n);b=a?m.hiddenCommentTextInput:m.visibleCommentTextInput;e[3]!==b?(n=[m.commentTextInput,b],e[3]=b,e[4]=n):n=e[4];e[5]!==g||e[6]!==n?(a=i.jsx(c("IGDSBox.react"),{children:i.jsx(c("IGDSTextInput.react"),{backgroundColor:"transparent",name:"shareCommentText",onChange:f,placeholder:d("PolarisDirectStrings").COMMENT_INPUT_PLACEHOLDER,style:"borderless",testid:void 0,value:g,xstyle:n})}),e[5]=g,e[6]=n,e[7]=a):a=e[7];return a}e=i.forwardRef(a);g["default"]=e}),98);
__d("IGDSecureShareSheetMessageBar.react",["IGDSBox.react","IGDSButton.react","IGDSecureShareSheetCommentTextInput.react","PolarisTrackingNodeProvider.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).unstable_useMemoCache,j=h;function a(a){var b=i(18),d=a.commentTextInputRef,e=a.isCommentTextInputHidden,f=a.isSendButtonDisabled,g=a.isSendButtonLoading,h=a.onSendClick,k=a.paddingX,l=a.sendButtonLabel;a=a.xstyle;e=e===void 0?!1:e;var m;b[0]!==e||b[1]!==d?(m=j.jsx(c("IGDSecureShareSheetCommentTextInput.react"),{isHidden:e,ref:d}),b[0]=e,b[1]=d,b[2]=m):m=b[2];b[3]!==k||b[4]!==m?(e=j.jsx(c("IGDSBox.react"),{paddingX:k,children:m}),b[3]=k,b[4]=m,b[5]=e):e=b[5];b[6]!==f||b[7]!==g||b[8]!==l||b[9]!==h?(d=j.jsx(c("PolarisTrackingNodeProvider.react"),{trackingNode:156,children:j.jsx("div",{children:j.jsx(c("IGDSButton.react"),{"aria-disabled":f,"data-testid":void 0,fullWidth:!0,isDisabled:f,isLoading:g,label:l,onClick:h})})}),b[6]=f,b[7]=g,b[8]=l,b[9]=h,b[10]=d):d=b[10];b[11]!==k||b[12]!==d?(m=j.jsx(c("IGDSBox.react"),{margin:4,marginTop:0,paddingX:k,children:d}),b[11]=k,b[12]=d,b[13]=m):m=b[13];b[14]!==a||b[15]!==e||b[16]!==m?(f=j.jsxs(c("IGDSBox.react"),{xstyle:a,children:[e,m]}),b[14]=a,b[15]=e,b[16]=m,b[17]=f):f=b[17];return f}g["default"]=a}),98);
__d("IGDSecureShareSheetUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=new Map();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e[0];e=e[1];var f=babelHelpers["extends"]({},e);f.candidate.id=e.candidate.igid;b.set(e.candidate.igid,f)}return b}f.getIGDCandidatesWithIGIDs=a}),66);
__d("PolarisDirectActionSendPostToUsers",["InstagramODS","PolarisDirectAPI","PolarisDirectActionConstants","PolarisDirectActionSendText","PolarisDirectActionThreadLoaded","PolarisDirectActionsLogger","PolarisDirectConstants","PolarisDirectStrings","PolarisToastActions","Promise","isStringNullOrEmpty","nullthrows","polarisDirectSelectors","polarisGenerateOfflineThreadingId"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var e=a.comment,f=a.customToast,g=a.mediaId,j=a.mediaOverlayInfo,k=a.mqtt,l=a.onError,m=a.onSuccess,n=a.recipients;return function(a,o){var p=function(b){f!=null?f({text:b}):a(d("PolarisToastActions").showToast({text:b}))};n.forEach(function(f,n){var q;f.type==="user"?q=d("polarisDirectSelectors").getThreadIdForUserId(o(),n):f.type==="thread"&&(q=n);d("PolarisDirectActionsLogger").directActionsLogger.logDirectEvent("http_message_attempt",{recipientType:f.type,type:d("PolarisDirectConstants").ThreadItemType.MEDIA_SHARE});q!=null?i(k,q,g,j).then(function(){m==null?void 0:m(n),d("PolarisDirectActionsLogger").directActionsLogger.logDirectEvent("http_message_success",{recipientType:f.type,type:d("PolarisDirectConstants").ThreadItemType.MEDIA_SHARE}),c("InstagramODS").incr("web.share_sheet.send_post"),p(d("PolarisDirectStrings").SENT_TOAST_TEXT)}).then(function(){var a=c("polarisGenerateOfflineThreadingId")();q!=null&&!c("isStringNullOrEmpty")(e)&&new(h||(h=b("Promise")))(function(a){window.setTimeout(a,d("PolarisDirectActionConstants").NUM_SEC_DELAY_FOR_SEND_TEXT*1e3)}).then(function(){return d("PolarisDirectActionSendText").sendText(k,c("nullthrows")(q),e,a)}).then(function(){d("PolarisDirectActionsLogger").directActionsLogger.logDirectEvent("http_message_success",{recipientType:f.type,type:d("PolarisDirectConstants").ThreadItemType.TEXT}),c("InstagramODS").incr("web.share_sheet.send_post_with_comment")})["catch"](function(a){d("PolarisDirectActionsLogger").directActionsLogger.logError("direct_send_message_to_users_failed",a),p(d("PolarisDirectStrings").GENERIC_ERROR_MESSAGE)})})["catch"](function(a){l==null?void 0:l(a,n),d("PolarisDirectActionsLogger").directActionsLogger.logError("direct_send_post_to_users_failed",a),p(d("PolarisDirectStrings").GENERIC_ERROR_MESSAGE)}):d("PolarisDirectAPI").createGroupThread([n]).then(function(o){var q=o.thread_id;a(d("PolarisDirectActionThreadLoaded").threadLoaded(o));i(k,q,g,j).then(function(){m==null?void 0:m(n),d("PolarisDirectActionsLogger").directActionsLogger.logDirectEvent("http_message_success",{type:d("PolarisDirectConstants").ThreadItemType.MEDIA_SHARE}),p(d("PolarisDirectStrings").SENT_TOAST_TEXT)}).then(function(){var a=c("polarisGenerateOfflineThreadingId")();q!=null&&!c("isStringNullOrEmpty")(e)&&new(h||(h=b("Promise")))(function(a){window.setTimeout(a,d("PolarisDirectActionConstants").NUM_SEC_DELAY_FOR_SEND_TEXT*1e3)}).then(function(){return d("PolarisDirectActionSendText").sendText(k,c("nullthrows")(q),e,a)}).then(function(){d("PolarisDirectActionsLogger").directActionsLogger.logDirectEvent("http_message_success",{recipientType:f.type,type:d("PolarisDirectConstants").ThreadItemType.TEXT}),p(d("PolarisDirectStrings").SENT_TOAST_TEXT)})["catch"](function(a){d("PolarisDirectActionsLogger").directActionsLogger.logError("direct_send_message_to_users_failed",a),p(d("PolarisDirectStrings").GENERIC_ERROR_MESSAGE)})})["catch"](function(a){l==null?void 0:l(a,n),d("PolarisDirectActionsLogger").directActionsLogger.logError("direct_send_post_to_users_failed",a)})},function(a){l==null?void 0:l(a,n),d("PolarisDirectActionsLogger").directActionsLogger.logError("direct_create_thread_send_post_to_users_failed",a),p(d("PolarisDirectStrings").GENERIC_ERROR_MESSAGE)})})}}function i(a,c,d,e){return a!=null?a.sendMediaShare(c,d,e):(h||(h=b("Promise"))).reject(new Error("MQTT is not instantiated"))}g.sendPostToUsers=a}),98);
__d("InstagramAdDirectReshareSendFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("3447");b=d("FalcoLoggerInternal").create("instagram_ad_direct_reshare_send",a);e=b;g["default"]=e}),98);
__d("useMaybeLogInstagramAdDirectReshareSend",["InstagramAdDirectReshareSendFalcoEvent","InstagramODS","PolarisContainerModuleUtils","PolarisViewpointActionUtils","polarisAdsSelectors.react","polarisRelationshipSelectors.react","react","usePolarisAnalyticsContext"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.unstable_useMemoCache;function a(a){var b=i(8),e=a.id,f=a.mediaType,g=a.mpk,h=a.ownerId,j=c("usePolarisAnalyticsContext")();b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(a){return a},b[0]=a):a=b[0];var k=d("polarisAdsSelectors.react").useFeedAdInfo(e,a),l=d("polarisRelationshipSelectors.react").useRelationship(h||"");b[1]!==k||b[2]!==l||b[3]!==j||b[4]!==h||b[5]!==g||b[6]!==f?(e=function(){if(k!=null&&k.ad_id!=null&&k.tracking_token!=null&&l!=null){var a=k.ad_id,b=k.tracking_token,e=d("PolarisContainerModuleUtils").getContainerModule(j);c("InstagramODS").incr("web.ads.feed.share");c("InstagramAdDirectReshareSendFalcoEvent").log(function(){var c;return{a_pk:(c=h)!=null?c:"",ad_id:a,follow_status:d("PolarisViewpointActionUtils").getFollowStatus(l),m_pk:g,m_t:f.toString(),pigeon_reserved_keyword_module:e,source_of_action:e,tracking_token:b}})}},b[1]=k,b[2]=l,b[3]=j,b[4]=h,b[5]=g,b[6]=f,b[7]=e):e=b[7];return e}g["default"]=a}),98);
__d("useShareSheetSendPostToOpenRecipients",["PolarisDirectActionSendPostToUsers","PolarisReactRedux.react","useMaybeLogInstagramAdDirectReshareSend","usePolarisMQTT","useStableCallback"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f=c("usePolarisMQTT")(),g=d("PolarisReactRedux.react").useDispatch(),h=c("useMaybeLogInstagramAdDirectReshareSend")({id:a.id,mediaType:a.mediaType,mpk:a.mpk,ownerId:a.ownerId});return c("useStableCallback")(function(c,i){g(d("PolarisDirectActionSendPostToUsers").sendPostToUsers({comment:(i=i)!=null?i:void 0,mediaId:String(a.id),mediaOverlayInfo:a.mediaOverlayInfo,mqtt:f,onError:e,onSuccess:b,recipients:c}));h()})}g["default"]=a}),98);
__d("IGDSecureShareSheetS2SInstanceKeyContextProvider.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=c.useRef,l=c.unstable_useMemoCache,m=e(new Map());function a(a){var b=l(3);a=a.children;var c;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(c=new Map(),b[0]=c):c=b[0];c=k(c);b[1]!==a?(c=i.jsx(m.Provider,{value:c.current,children:a}),b[1]=a,b[2]=c):c=b[2];return c}function b(){return j(m)}g.IGDSecureShareSheetS2SInstanceKeyContextProvider=a;g.useIGDSecureShareSheetS2SInstanceKeyContext=b}),98);
__d("useShareSheetSendPostToSecureRecipients",["IGDAWShareAttachment","IGDSecureShareSheetS2SInstanceKeyContextProvider.react","PolarisDirectStrings","PolarisReactRedux.react","PolarisToastActions","Promise","asyncToGeneratorRuntime","qpl","useStableCallback"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e,f,g){var i=d("PolarisReactRedux.react").useDispatch(),j=d("IGDSecureShareSheetS2SInstanceKeyContextProvider.react").useIGDSecureShareSheetS2SInstanceKeyContext();return c("useStableCallback")(function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(k,l){k=Array.from(k.values()).map(function(b){var h=c("qpl")._(832770902,"1857"),i=j.get(b.candidate.id);return d("IGDAWShareAttachment").shareIGPostAsSecureAttachment(a,e,b,l,h,i).then(function(){return f==null?void 0:f(b.candidate.id)},function(a){return g==null?void 0:g(a,b.candidate.id)})});i(d("PolarisToastActions").showToast({text:d("PolarisDirectStrings").SENT_TOAST_TEXT}));yield (h||(h=b("Promise"))).allSettled(k)});return function(a,b){return k.apply(this,arguments)}}())}g["default"]=a}),98);
__d("useShareSheetSendStoryToOpenRecipients",["PolarisDirectActionShareStory","PolarisReactRedux.react","usePolarisMQTT","useStableCallback"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=c("usePolarisMQTT")(),f=d("PolarisReactRedux.react").useDispatch();return c("useStableCallback")(function(c,g,h,i,j){var k="";g=g;g!=null&&(k=c+"_"+g);f(d("PolarisDirectActionShareStory").shareStory(e,i,h,k,j,a,b))})}g["default"]=a}),98);
__d("useShareSheetSendPostToRecipients",["IGDSecureShareSheetUtils","PolarisInteractionsLogger","PolarisViewpointActionUtils","asyncToGeneratorRuntime","react","useShareSheetSendPostToOpenRecipients","useShareSheetSendPostToSecureRecipients","useShareSheetSendStoryToOpenRecipients"],(function(a,b,c,d,e,f,g){"use strict";var h;e=h||d("react");e.useCallback;var i=e.unstable_useMemoCache;function a(a,e,f,g,h){var j,k=i(8);j=(j=d("PolarisViewpointActionUtils").getMPKForFeedMedia({id:a.id,owner:(j=e)!=null?j:void 0}))!=null?j:"";var l=d("PolarisInteractionsLogger").getMediaTypeFromPost(a),m=c("useShareSheetSendStoryToOpenRecipients")(g,h),n=c("useShareSheetSendPostToOpenRecipients")({id:a.id,mediaOverlayInfo:a.mediaOverlayInfo,mediaType:l,mpk:j,ownerId:e==null?void 0:e.id},g,h),o=c("useShareSheetSendPostToSecureRecipients")(a,e,g,h);k[0]!==a.productType||k[1]!==a.id||k[2]!==f||k[3]!==m||k[4]!==e||k[5]!==n||k[6]!==o?(l=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){var g=b.openRecipients;b=b.secureRecipients;if(g!=null){g=d("IGDSecureShareSheetUtils").getIGDCandidatesWithIGIDs(g);a.productType==="story"&&f!=null?m(a.id,e==null?void 0:e.id,f,g,c):n(g,c)}b!=null&&(yield o(b,c))});return function(a,b){return c.apply(this,arguments)}}(),k[0]=a.productType,k[1]=a.id,k[2]=f,k[3]=m,k[4]=e,k[5]=n,k[6]=o,k[7]=l):l=k[7];return l}g["default"]=a}),98);
__d("IGDSecureShareSheet.react",["FBLogger","IGDAWContactSearch.react","IGDContactSearchDialogType.flow","IGDSBox.react","IGDSDivider.react","IGDSecureShareSheetMessageBar.react","InteractionTracing","PolarisDirectActionInitInbox","PolarisDirectLogger","PolarisDirectStrings","PolarisLoggerUtils","PolarisReactRedux.react","PolarisToastActions","PolarisTrackingCodeProvider.react","gkx","isStringNullOrEmpty","polarisAdsSelectors.react","promiseDone","react","usePolarisAnalyticsContext","usePolarisMQTT","usePolarisSelector","useShareSheetSendPostToRecipients"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef,l=b.useState,m=b.unstable_useMemoCache;function a(a){var b=m(40),e=a.adsStoryLoggingData,f=a.isPopover,g=a.isSupershare,h=a.onAddRecipient,n=a.onRemoveRecipient,o=a.onShareError,p=a.onShareSuccess,q=a.onSubmitClick,r=a.post;a=a.reelId;var s=c("usePolarisMQTT")();c("InteractionTracing").getPendingInteractions().forEach(function(a){a.addAnnotationBoolean("is_mqtt_available",Boolean(s!=null))});var t;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(t=function(a){return a},b[0]=t):t=b[0];t=d("polarisAdsSelectors.react").useFeedAdInfo(r.id,t);var u=c("usePolarisAnalyticsContext")(),v=k(null),w=l(!1),x=w[0],y=w[1];b[1]===Symbol["for"]("react.memo_cache_sentinel")?(w=new Map(),b[1]=w):w=b[1];w=l(w);var z=w[0];w=w[1];var A=d("PolarisReactRedux.react").useDispatch(),B;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(B=function(a){return a.direct.inboxLoaded},b[2]=B):B=b[2];var C=c("usePolarisSelector")(B),D;b[3]!==C||b[4]!==A?(B=function(){!C&&!c("gkx")("3374")&&A(d("PolarisDirectActionInitInbox").initInbox())},D=[A,C],b[3]=C,b[4]=A,b[5]=B,b[6]=D):(B=b[5],D=b[6]);j(B,D);var E=c("useShareSheetSendPostToRecipients")(r,r.owner,a,p,o);b[7]!==z||b[8]!==q||b[9]!==u||b[10]!==E||b[11]!==A?(B=function(){var a;y(!0);var b=new Map(),e=new Map(),f=[];z.forEach(function(a){a.candidate.isE2EE?(e.set(a.candidate.id,a),f.push(a.candidate.id)):c("isStringNullOrEmpty")(a.candidate.igid)||(b.set(a.candidate.igid,a),f.push(a.candidate.igid))});a=(a=v.current)==null?void 0:a.getComment();q==null?void 0:q(f,a);d("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectShareSheet","share_sheet_send",{referral:u});c("promiseDone")(E({openRecipients:b,secureRecipients:e},a),function(){y(!1)},function(a){y(!1),c("FBLogger")("igd_web_on_msgr").mustfix("Error sharing attachment to users in sharesheet:"+a.message),A(d("PolarisToastActions").showToast({text:d("PolarisDirectStrings").GENERIC_ERROR_MESSAGE}))})},b[7]=z,b[8]=q,b[9]=u,b[10]=E,b[11]=A,b[12]=B):B=b[12];D=B;a=z.size!==0;p=x;b[13]!==s||b[14]!==p||b[15]!==a?(o=s==null||p||!a,b[13]=s,b[14]=p,b[15]=a,b[16]=o):o=b[16];B=o;x=f===!0?4:void 0;o="";f=!1;if((e==null?void 0:e.tracking_token)!=null){var F;o=(F=e==null?void 0:e.tracking_token)!=null?F:"";f=(e==null?void 0:e.tracking_token)!=null}else(t==null?void 0:t.ad_id)!=null&&(t==null?void 0:t.tracking_token)!=null&&(o=t.tracking_token,f=!0);if(b[17]!==r){t=((F=r.owner)==null?void 0:F.id)?d("PolarisLoggerUtils").getFormattedMediaID(r.id,(e=r.owner)==null?void 0:e.id):"";b[17]=r;b[18]=t}else t=b[18];b[19]!==x||b[20]!==g||b[21]!==h||b[22]!==n||b[23]!==z?(F=i.jsx(c("IGDSBox.react"),{flex:"grow",children:i.jsx(c("IGDAWContactSearch.react"),{includeGroupSearch:!0,insetPaddingX:x,isSupershare:g,maxRecipients:32,onAddRecipient:h,onRemoveRecipient:n,recipients:z,searchType:d("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.SHARESHEET,setRecipients:w})}),b[19]=x,b[20]=g,b[21]=h,b[22]=n,b[23]=z,b[24]=F):F=b[24];b[25]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx(c("IGDSDivider.react"),{style:"elevated"}),b[25]=e):e=b[25];r=!a;w=z.size<2?d("PolarisDirectStrings").SEND_BUTTON_STRING:d("PolarisDirectStrings").SEND_SEPARATELY_BUTTON_STRING;b[26]!==v||b[27]!==r||b[28]!==B||b[29]!==p||b[30]!==D||b[31]!==x||b[32]!==w?(g=i.jsx(c("IGDSecureShareSheetMessageBar.react"),{commentTextInputRef:v,isCommentTextInputHidden:r,isSendButtonDisabled:B,isSendButtonLoading:p,onSendClick:D,paddingX:x,sendButtonLabel:w}),b[26]=v,b[27]=r,b[28]=B,b[29]=p,b[30]=D,b[31]=x,b[32]=w,b[33]=g):g=b[33];b[34]!==f||b[35]!==t||b[36]!==o||b[37]!==F||b[38]!==g?(h=i.jsx(c("IGDSBox.react"),{"data-testid":void 0,flex:"grow",children:i.jsxs(c("PolarisTrackingCodeProvider.react"),{isSponsored:f,m_pk:t,trackingToken:o,children:[F,e,g]})}),b[34]=f,b[35]=t,b[36]=o,b[37]=F,b[38]=g,b[39]=h):h=b[39];return h}g["default"]=a}),98);
__d("useIGDSecureShareSheetS2SLogger",["IGDSecureShareSheetS2SInstanceKeyContextProvider.react","QPLUserFlow","Random","qpl","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useMemo;var i=b.unstable_useMemoCache;function a(){var a=i(2),b=d("IGDSecureShareSheetS2SInstanceKeyContextProvider.react").useIGDSecureShareSheetS2SInstanceKeyContext(),e;a[0]!==b?(e={markShareFail:function(a,d){var e=b.get(d);e!=null&&c("QPLUserFlow").endFailure(c("qpl")._(832770902,"1857"),a.name,{error:a,instanceKey:e});b["delete"](d)},markShareStart:function(a,e){for(var a=a,f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h,i;if(f){if(g>=a.length)break;i=a[g++]}else{g=a.next();if(g.done)break;i=g.value}i=i;var j=d("Random").uint32();b.set(i,j);c("QPLUserFlow").start(c("qpl")._(832770902,"1857"),{annotations:{string:{messageLength:(h=e.messageLength)==null?void 0:h.toString(),recipientID:i,shareType:e.shareType,source:e.source}},instanceKey:j})}},markShareSuccess:function(a){var d=b.get(a);d!=null&&c("QPLUserFlow").endSuccess(c("qpl")._(832770902,"1857"),{instanceKey:d});b["delete"](a)}},a[0]=b,a[1]=e):e=a[1];a=e;return a}g["default"]=a}),98);
__d("IGDSecureShareSheetContainer.react",["IGDContactSearchDialogType.flow","IGDSecureShareSheet.react","IGDSecureShareSheetS2SInstanceKeyContextProvider.react","InstagramAdDirectReshareSendFalcoEvent","InstagramODS","QPLUserFlow","emptyFunction","qpl","react","useIGDSecureShareSheetInteractionLogger","useIGDSecureShareSheetS2SLogger","usePolarisAnalyticsContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).unstable_useMemoCache,j=h;function k(a){var b=i(34),e=a.adsStoryLoggingData,f=a.flowInstanceId,g=a.isPopover,h=a.isSupershare,k=a.onClose,l=a.post;a=a.reelId;var m=k===void 0?c("emptyFunction"):k;k=c("usePolarisAnalyticsContext")();var n=c("useIGDSecureShareSheetS2SLogger")(),o=d("useIGDSecureShareSheetInteractionLogger").useLogShareSheetInteraction();if(!l.id)return null;var p;b[0]!==f||b[1]!==k?(p={flowInstanceId:f,shareType:d("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.SHARESHEET,source:k},b[0]=f,b[1]=k,b[2]=p):p=b[2];var q=p;b[3]!==q||b[4]!==n||b[5]!==o||b[6]!==e||b[7]!==m?(f=function(a,b){b=b===void 0?"":b;b=babelHelpers["extends"]({},q,{messageLength:b==null?void 0:b.length,recipientIDs:a});n.markShareStart(a,b);o("igd_sharesheet_share_attempt",b);c("QPLUserFlow").addPoint(c("qpl")._(379205139,"1723"),"share_sheet_send_click");(e==null?void 0:e.ad_id)!=null&&(c("InstagramODS").incr("web.ads.story.share"),c("InstagramAdDirectReshareSendFalcoEvent").log(function(){return e}));m()},b[3]=q,b[4]=n,b[5]=o,b[6]=e,b[7]=m,b[8]=f):f=b[8];k=f;b[9]!==n||b[10]!==o||b[11]!==q?(p=function(a){n.markShareSuccess(a),c("QPLUserFlow").endSuccess(c("qpl")._(379205139,"1723")),o("igd_sharesheet_share_success",babelHelpers["extends"]({},q,{recipientIDs:[a]}))},b[9]=n,b[10]=o,b[11]=q,b[12]=p):p=b[12];f=p;b[13]!==n||b[14]!==o||b[15]!==q?(p=function(a,b){n.markShareFail(a,b),c("QPLUserFlow").endFailure(c("qpl")._(379205139,"1723"),a.name),o("igd_sharesheet_share_error",babelHelpers["extends"]({},q,{recipientIDs:[b]}))},b[13]=n,b[14]=o,b[15]=q,b[16]=p):p=b[16];p=p;var r;b[17]!==o||b[18]!==q?(r=function(){o("igd_contact_search_add_recipient",q)},b[17]=o,b[18]=q,b[19]=r):r=b[19];r=r;var s;b[20]!==o||b[21]!==q?(s=function(){o("igd_contact_search_remove_recipient",q)},b[20]=o,b[21]=q,b[22]=s):s=b[22];s=s;var t;b[23]!==e||b[24]!==g||b[25]!==h||b[26]!==r||b[27]!==s||b[28]!==p||b[29]!==f||b[30]!==k||b[31]!==l||b[32]!==a?(t=j.jsx(c("IGDSecureShareSheet.react"),{adsStoryLoggingData:e,isPopover:g,isSupershare:h,onAddRecipient:r,onRemoveRecipient:s,onShareError:p,onShareSuccess:f,onSubmitClick:k,post:l,reelId:a}),b[23]=e,b[24]=g,b[25]=h,b[26]=r,b[27]=s,b[28]=p,b[29]=f,b[30]=k,b[31]=l,b[32]=a,b[33]=t):t=b[33];return t}function a(a){var b=i(2),c;b[0]!==a?(c=j.jsx(d("IGDSecureShareSheetS2SInstanceKeyContextProvider.react").IGDSecureShareSheetS2SInstanceKeyContextProvider,{children:j.jsx(k,babelHelpers["extends"]({},a))}),b[0]=a,b[1]=c):c=b[1];return c}g["default"]=a}),98);